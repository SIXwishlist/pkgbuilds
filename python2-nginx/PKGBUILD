# Maintainer: Jacob Cook <jacob at citizenweb dot io>

pkgname=python2-nginx
pkgver=0.1.4
pkgrel=1
pkgdesc="Create and modify nginx serverblock configs in Python"

arch=('any')
url="https://git.coderouge.co/coderouge/python-nginx"
license=('GPLv3')
depends=('python2')
makedepends=('python2' 'python2-distribute')
source=("$pkgname-$pkgver.tar.gz"::"https://git.coderouge.co/coderouge/python-nginx/repository/archive.tar.gz?ref=$pkgver")
md5sums=('72b8d0a0f5d5c5cfa27de67e5d48fb48')

build() {
  cd "$srcdir"
  tar xvzf "$pkgname-$pkgver.tar.gz"

  msg2 'Replacing python shebang by python2 shebang...'
  find . -type f -exec sed -i \
    -e'1s|^#!/usr/bin/env python$|#!/usr/bin/env python2|' \
    -e '1s|^#!/usr/bin/python$|#!/usr/bin/env python2|' \
    "{}" \;
}

package() {
  cd "$srcdir/python-nginx.git"
  python2 setup.py install --root="$pkgdir/" --optimize=1
}
